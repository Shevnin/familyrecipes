# Flow: «Повторяю один рецепт и учусь» — перечень функций (v0 → v1)

Цель: я беру **один рецепт** и готовлю его много раз. Приложение помогает **выполнить без ошибок** и **прокачать навык** через интерактив по шагам, таймеры, чекпоинты и обратную связь.

---

## A. Запуск повторения

### A1. Entry points
- Кнопка **«Начать готовку»** из карточки рецепта.
- Быстрый запуск **«Повторить последний рецепт»** (из главного экрана / истории).
- Режимы запуска:
  - **Новичок** (подсказки + вопросы)
  - **Обычный** (короче, подсказки свернуты)
  - **Экзамен** (минимум подсказок)

### A2. Сессия готовки
- Создание **Cooking Session** (attempt #1 / #2 / #3…).
- Автосохранение прогресса: текущий шаг, таймеры, заметки по шагам.
- Пауза/возврат в сессию (resume).

---

## B. Экран «Готовка» (интерактив по шагам)

### B1. Формат “one step at a time”
- Один экран = **один шаг** (карточка шага).
- Кнопки навигации: **Назад / Дальше / Пауза / Завершить**.
- Быстрые действия на шаге:
  - **«Повторить шаг»**
  - **«Пропустить»** (если допустимо)
  - **«Отметить как выполнено»**

### B2. Контент шага (структура)
- Заголовок шага: действие (например, «Пассировать лук»).
- Короткая инструкция (1–2 предложения).
- Параметры:
  - тайминг (примерно)
  - огонь/температура
  - интенсивность (мешать/не мешать)
- **Маркеры готовности** (визуальные/текстурные признаки):
  - цвет, запах, консистенция, звук
  - примеры: «до прозрачности», «до мягких пиков», «до золотистой корочки»
- **Стоп-ошибки/критические нюансы**:
  - «не перегреть», «солить в конце», «не кипятить после добавления…»

---

## C. Таймеры и события времени

### C1. Таймеры внутри шага
- Кнопка **«Старт таймер»** (1 тап).
- Таймер с состояниями: running / paused / done.
- Несколько таймеров в одном шаге (опционально):
  - основной таймер + периодические напоминания (каждые 30 сек помешать)

### C2. Умные напоминания (минимальный v0)
- Сигнал «таймер закончился» + действие:
  - «проверь маркеры готовности»
- Быстрые кнопки:
  - «Готово»
  - «+1 мин»
  - «Ещё не готово» → подсказка

---

## D. Контрольные вопросы (чекпоинты)

### D1. Вопросы в критических местах
- Типы вопросов:
  - бинарные: **Да/Нет**
  - тройные: **Да / Нет / Не уверен**
  - выбор состояния: «жидкий / норм / слишком густой»
- Примеры:
  - «Лук стал прозрачным?»
  - «Соус загустел (стекает лентой)?»
  - «Курица прожарилась (сок прозрачный)?»

### D2. Реакции на ответы
- Если **Нет** → краткая корректировка:
  - «ещё 2–3 минуты, огонь средний»
- Если **Не уверен** → “мини-справка” по признакам.
- Возможность отметить «сделал по-своему» (фиксируется в attempt-notes).

---

## E. Подсказки по техникам (skill modules)

### E1. Техника как сущность, привязанная к шагу
- В шаге отображается плашка техники: «Пассировать» / «Деглазировать» и т.д.
- По тапу открывается карточка:
  - цель техники
  - признаки правильности
  - типовые ошибки
  - ориентировочное время
- Подсказка может быть:
  - скрыта по умолчанию (в Обычном/Экзамене)
  - раскрыта по умолчанию (в Новичке)

---

## F. Заметки и микро-лог по ходу

### F1. Быстрая заметка в шаге
- Кнопка **«Заметка»** на шаге (короткий текст).
- Шаблонные чипы (если есть):
  - «слишком солёно»
  - «подгорело»
  - «нужно больше воды»
  - «огонь ниже»
- Привязка заметки к шагу и attempt’у.

### F2. Метки проблем (структурно)
- Чекбоксы типовых ошибок (по рецепту или общие):
  - «пересолил»
  - «недожарил»
  - «сухо»
  - «слишком жидко»
  - «прилипает»

---

## G. Финал готовки: быстрый дебриф (20–40 секунд)

### G1. Экран “Как прошло?”
- 3–5 быстрых вопросов:
  - вкус (1–5)
  - текстура (1–5)
  - сложность (1–5)
  - получилось/не получилось (да/нет)
- Поле «Что изменить в следующий раз?» (1 строка).
- Кнопка **«Сохранить attempt»**.

### G2. Автоматическое резюме попытки
- Attempt #N: дата, режим (Новичок/Обычный/Экзамен), оценка.
- Список “что пошло не так” + 1 заметка “в следующий раз”.

---

## H. Повторный запуск: персональные подсказки из прошлого опыта

### H1. In-step “прошлые заметки”
- При старте следующей попытки приложение поднимает:
  - заметки прошлого attempt’а, привязанные к шагам
  - стоп-ошибки, отмеченные пользователем
- Отображение прямо в шаге блоком:
  - «В прошлый раз: пересолил → солить в конце»

### H2. Закрепление “важных уроков”
- Возможность пометить заметку как **«важно всегда»**:
  - закрепляется в рецепте как постоянный нюанс/стоп-ошибка

---

## I. Адаптация рецепта (rule-based, без “магии”)

### I1. Предложения улучшений на основе повторяющихся проблем
- Если одна проблема встречается ≥ 2–3 раза:
  - «Слишком сухо» → предложить “+30 мл воды/бульона на шаге X”
  - «Подгорает» → “огонь ниже + мешать чаще на шаге Y”
  - «Слишком жидко» → “увеличить время выпаривания на шаге Z”
- Два варианта действия:
  - **Принять** (создать вариант рецепта)
  - **Игнорировать**

### I2. Вариации рецепта (v1)
- Создать “Вариант v2” из базового рецепта:
  - отличия фиксируются (что изменил: граммовка/время/температура)
- Быстрое сравнение:
  - “базовый vs v2” (только отличия)

---

## J. Уровни подсказок (прокачка)

### J1. Новичок
- Полные подсказки + чекпоинты + техники развернуты.
- Таймеры предлагаются автоматически.

### J2. Обычный
- Подсказки свернуты (по запросу).
- Вопросы только в критических местах.

### J3. Экзамен
- Минимальный текст.
- Таймеры остаются, но подсказки скрыты.
- После попытки — подсказка “где были ошибки”.

---

## K. Тестовый прогон (репетиция перед готовкой)

Цель: перед реальной готовкой пользователь делает **быструю репетицию** (1–2 минуты), чтобы проверить себя по **чеклисту контрольных точек** и не пропустить критические моменты.

### K1. Entry points
- Кнопка **«Тестовый прогон»** на карточке рецепта (рядом с «Начать готовку»).
- Модалка перед стартом готовки: «Сначала тестовый прогон?» → **Да / Нет**.

### K2. Форматы (2 варианта + default)
- **Default (v0): Чеклист по контрольным точкам**
  - «Ингредиенты готовы»
  - «Инструменты готовы» (опционально, если задано в рецепте)
  - «Понял стоп-ошибки» (3–5 пунктов)
  - «Понял маркеры готовности» (3–5 пунктов)
  - «Понял тайминг ключевых шагов» (шаги с таймером)
  - CTA: **«Начать готовку»**
- **Вариант 2 (v1): Мини‑квиз (самопроверка)**
  - 5–8 коротких вопросов по стоп-точкам/признакам/действиям при проблемах.
  - Результат: «Готов» или «Проверь шаги X/Y».

### K3. Откуда берутся пункты
- Автогенерация из рецепта:
  - контрольные вопросы (checkpoints)
  - стоп-ошибки/критические нюансы
  - маркеры готовности
  - шаги с таймером

### K4. Влияние на готовку
- Если чеклист не пройден: предупреждение + выбор **«Всё равно начать» / «Вернуться»**.
- Факт репетиции сохраняется в attempt: `preflight_completed = true`.

---

## L. Минимальный MVP-комплект (рекомендованный default)
Чтобы flow уже ощущался “не тетрадкой”, достаточно:
- One-step cooking mode (B1)
- Таймер на шаге (C1)
- 1–2 контрольных вопроса в рецепте (D1–D2)
- Debrief после готовки (G1)
- Показ прошлых заметок в нужных шагах (H1)

---

## M. Nice-to-have (после v0)
- Фото-референсы “как выглядит правильно” (включая “мои фото”).
- Периодические напоминания внутри шага (каждые N секунд).
- “Экзамен” с оценкой по ошибкам/чекпоинтам.
- Авто-генерация чипов ошибок и подсказок на основе текста заметок.
- Масштабирование порций (х2/х0.5) как отдельная функция рецепта.