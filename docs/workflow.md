# Workflow: Человек + ChatGPT (Codex) + Claude Code

## Роли

- **Человек (Owner)**: решает, что делать дальше; принимает или отклоняет результат.
- **ChatGPT (Codex)**: продуктовая голова — гипотезы, flow, product brief, ревью документации, формулировка следующего шага.
- **Claude Code**: руки — код, коммиты, пуш, деплой, обновление docs по результату.

## Граница фаз (жесткое правило)

- Пока не стартовала реальная мобильная разработка (Flutter) и backend, всё считается **product discovery**.
- Прототипы, моки, UI-эксперименты, Pages-деплой до этого момента — discovery-работа.
- **Delivery** начинается только после запуска мобильной + серверной реализации.

## Единый источник текущего контекста

- Главный файл handoff: `docs/current_state.md`
- Он обязателен для обновления после каждой рабочей сессии (Codex или Claude).

## Протокол восстановления контекста (новая сессия)

### Для Codex
1. Прочитать `docs/current_state.md`.
2. Прочитать последнюю запись из `docs/sessions/` (по дате).
3. Проверить последние решения в `docs/decisions.md`.
4. Сверить `docs/roadmap.md` и `docs/backlog.md` с фактом в сессии.
5. Явно зафиксировать "контекст восстановлен" и только потом предлагать следующий шаг.

### Для Claude Code
1. Прочитать `docs/current_state.md`.
2. Прочитать целевую задачу (из чата или по шаблону `docs/templates/delivery_task_template.md`).
3. Прочитать последнюю запись в `docs/sessions/`.
4. Перед началом реализации коротко подтвердить понимание scope и acceptance criteria.
5. После выполнения обновить `docs/sessions/` и `docs/current_state.md`.

## Цикл работы

1. Codex формулирует следующий шаг (задача/план).
2. Owner передает задачу Claude.
3. Claude реализует, коммитит, пушит, фиксирует итог в `docs/sessions/`.
4. Codex ревьюит обновленные docs и синхронизирует roadmap/backlog/decisions.
5. Повторяем цикл.

## Правила завершения любой сессии

- Есть запись в `docs/sessions/` с тем, что сделано.
- Обновлен `docs/current_state.md`:
  - что сейчас за фаза
  - где остановились
  - что делать первым шагом в новой сессии
- Если принято новое решение — обновлен `docs/decisions.md`.
- Если изменились приоритеты — обновлены `docs/roadmap.md` и `docs/backlog.md`.

## Обязательные артефакты

- Продуктовая рамка: `docs/product_brief.md`
- Текущий статус (handoff): `docs/current_state.md`
- Roadmap: `docs/roadmap.md`
- Backlog: `docs/backlog.md`
- Журнал решений: `docs/decisions.md`
- Протоколы сессий: `docs/sessions/`
- Шаблоны: `docs/templates/`
